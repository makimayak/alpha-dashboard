<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alpha Dashboard üî¥ü§çüå∏</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: linear-gradient(135deg, #0f0f0f 0%, #1a0a0a 100%); }
        .token-card { transition: all 0.2s ease; }
        .token-card:hover { transform: translateY(-4px); box-shadow: 0 10px 40px rgba(239, 68, 68, 0.2); }
        .glow { box-shadow: 0 0 20px rgba(239, 68, 68, 0.3); }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .gradient-text { background: linear-gradient(90deg, #ef4444, #ffffff, #f472b6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="text-white min-h-screen">
    <!-- Header -->
    <header class="border-b border-gray-800 bg-black/50 backdrop-blur-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold gradient-text">Alpha Dashboard</h1>
                    <p class="text-gray-500 text-sm">Squad Built üî¥ü§çüå∏</p>
                </div>
                <div class="flex items-center gap-4">
                    <span id="status" class="flex items-center gap-2 text-sm">
                        <span class="w-2 h-2 bg-green-500 rounded-full pulse"></span>
                        <span class="text-gray-400">Live</span>
                    </span>
                    <button onclick="fetchTokens()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg font-semibold text-sm">
                        üîÑ Refresh
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-6">
        <!-- Stats Bar -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-gray-900/50 rounded-xl p-4 border border-gray-800">
                <p class="text-gray-400 text-sm">Tokens Found</p>
                <p id="tokenCount" class="text-2xl font-bold text-white">--</p>
            </div>
            <div class="bg-gray-900/50 rounded-xl p-4 border border-gray-800">
                <p class="text-gray-400 text-sm">Total Volume</p>
                <p id="totalVolume" class="text-2xl font-bold text-green-400">--</p>
            </div>
            <div class="bg-gray-900/50 rounded-xl p-4 border border-gray-800">
                <p class="text-gray-400 text-sm">Avg Change</p>
                <p id="avgChange" class="text-2xl font-bold">--</p>
            </div>
            <div class="bg-gray-900/50 rounded-xl p-4 border border-gray-800">
                <p class="text-gray-400 text-sm">Last Update</p>
                <p id="lastUpdateTime" class="text-2xl font-bold text-gray-300">--</p>
            </div>
        </div>

        <!-- Filters -->
        <div class="bg-gray-900/50 rounded-xl p-4 border border-gray-800 mb-6">
            <div class="flex flex-wrap gap-4 items-center">
                <div>
                    <label class="text-xs text-gray-400 block mb-1">Min Volume</label>
                    <select id="minVolume" class="bg-gray-800 border border-gray-700 px-3 py-2 rounded-lg text-sm">
                        <option value="10000">$10K</option>
                        <option value="25000">$25K</option>
                        <option value="50000" selected>$50K</option>
                        <option value="100000">$100K</option>
                        <option value="500000">$500K</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs text-gray-400 block mb-1">Min Liquidity</label>
                    <select id="minLiquidity" class="bg-gray-800 border border-gray-700 px-3 py-2 rounded-lg text-sm">
                        <option value="5000">$5K</option>
                        <option value="10000" selected>$10K</option>
                        <option value="25000">$25K</option>
                        <option value="50000">$50K</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs text-gray-400 block mb-1">Sort By</label>
                    <select id="sortBy" class="bg-gray-800 border border-gray-700 px-3 py-2 rounded-lg text-sm">
                        <option value="volume">Volume (High‚ÜíLow)</option>
                        <option value="liquidity">Liquidity (High‚ÜíLow)</option>
                        <option value="change">Price Change</option>
                        <option value="mcap">Market Cap</option>
                    </select>
                </div>
                <div class="ml-auto">
                    <button onclick="openChecklist()" class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg text-sm font-semibold">
                        üìã Trade Checklist
                    </button>
                </div>
            </div>
        </div>

        <!-- Token Grid -->
        <div id="loading" class="text-center text-gray-400 py-12">
            <div class="inline-block w-8 h-8 border-4 border-red-500 border-t-transparent rounded-full animate-spin mb-4"></div>
            <p>Loading tokens...</p>
        </div>
        <div id="tokens" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"></div>
    </main>

    <!-- Trade Checklist Modal -->
    <div id="checklistModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-gray-900 rounded-2xl max-w-lg w-full p-6 border border-gray-700">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold">üìã Leverage Trade Checklist</h2>
                <button onclick="closeChecklist()" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>
            <div class="space-y-4">
                <label class="flex items-start gap-3 p-3 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-750">
                    <input type="checkbox" class="mt-1 w-5 h-5 rounded">
                    <div>
                        <p class="font-semibold">Technical Analysis ‚úì</p>
                        <p class="text-sm text-gray-400">Checked trend, S/R levels, RSI, volume</p>
                    </div>
                </label>
                <label class="flex items-start gap-3 p-3 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-750">
                    <input type="checkbox" class="mt-1 w-5 h-5 rounded">
                    <div>
                        <p class="font-semibold">Macro Context ‚úì</p>
                        <p class="text-sm text-gray-400">No major events (Fed, CPI, options expiry)</p>
                    </div>
                </label>
                <label class="flex items-start gap-3 p-3 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-750">
                    <input type="checkbox" class="mt-1 w-5 h-5 rounded">
                    <div>
                        <p class="font-semibold">Position Size ‚úì</p>
                        <p class="text-sm text-gray-400">Max 1-2% portfolio risk, liquidation level known</p>
                    </div>
                </label>
                <label class="flex items-start gap-3 p-3 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-750">
                    <input type="checkbox" class="mt-1 w-5 h-5 rounded">
                    <div>
                        <p class="font-semibold">Entry Criteria ‚úì</p>
                        <p class="text-sm text-gray-400">Clear invalidation, min 2:1 risk/reward</p>
                    </div>
                </label>
                <label class="flex items-start gap-3 p-3 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-750">
                    <input type="checkbox" class="mt-1 w-5 h-5 rounded">
                    <div>
                        <p class="font-semibold">No Red Flags ‚úì</p>
                        <p class="text-sm text-gray-400">No FOMO, not chasing, funding rates normal</p>
                    </div>
                </label>
            </div>
            <div class="mt-6 p-4 bg-red-900/30 border border-red-800 rounded-lg">
                <p class="text-sm text-red-300">‚ö†Ô∏è "If this goes against me immediately, am I okay with the loss?"</p>
                <p class="text-xs text-gray-400 mt-1">If no ‚Üí reduce size or skip the trade.</p>
            </div>
        </div>
    </div>

    <footer class="border-t border-gray-800 mt-12 py-6 text-center text-gray-500 text-sm">
        Built by the Squad üî¥ü§çüå∏ | Data from DexScreener | Auto-refreshes every 30s
    </footer>

    <script>
        let allTokens = [];

        async function fetchTokens() {
            const loading = document.getElementById('loading');
            const tokensDiv = document.getElementById('tokens');
            const minVolume = parseInt(document.getElementById('minVolume').value);
            const minLiquidity = parseInt(document.getElementById('minLiquidity').value);
            const sortBy = document.getElementById('sortBy').value;

            loading.style.display = 'block';
            tokensDiv.innerHTML = '';

            try {
                const response = await fetch('https://api.dexscreener.com/token-profiles/latest/v1');
                const profiles = await response.json();
                
                const solanaTokens = profiles.filter(t => t.chainId === 'solana').slice(0, 100);
                const addresses = solanaTokens.map(t => t.tokenAddress);
                
                // Batch requests (30 at a time)
                let allPairs = [];
                for (let i = 0; i < addresses.length; i += 30) {
                    const batch = addresses.slice(i, i + 30).join(',');
                    const pairsResponse = await fetch(`https://api.dexscreener.com/tokens/v1/solana/${batch}`);
                    const pairsData = await pairsResponse.json();
                    allPairs = allPairs.concat(pairsData);
                }
                
                allTokens = allPairs.filter(p => p.volume?.h24 >= minVolume && p.liquidity?.usd >= minLiquidity);
                
                // Sort
                allTokens.sort((a, b) => {
                    if (sortBy === 'volume') return (b.volume?.h24 || 0) - (a.volume?.h24 || 0);
                    if (sortBy === 'liquidity') return (b.liquidity?.usd || 0) - (a.liquidity?.usd || 0);
                    if (sortBy === 'change') return (b.priceChange?.h24 || 0) - (a.priceChange?.h24 || 0);
                    if (sortBy === 'mcap') return (b.marketCap || 0) - (a.marketCap || 0);
                    return 0;
                });

                allTokens = allTokens.slice(0, 24);
                loading.style.display = 'none';
                renderTokens();
                updateStats();
            } catch (error) {
                loading.style.display = 'none';
                tokensDiv.innerHTML = `<p class="col-span-full text-center text-red-400 py-8">Error: ${error.message}</p>`;
            }
        }

        function renderTokens() {
            const tokensDiv = document.getElementById('tokens');
            tokensDiv.innerHTML = '';

            if (allTokens.length === 0) {
                tokensDiv.innerHTML = '<p class="col-span-full text-center text-gray-400 py-8">No tokens match filters</p>';
                return;
            }

            allTokens.forEach((token, i) => {
                const priceChange = token.priceChange?.h24 || 0;
                const changeColor = priceChange >= 0 ? 'text-green-400' : 'text-red-400';
                const changeBg = priceChange >= 0 ? 'bg-green-500/10' : 'bg-red-500/10';
                const changeSign = priceChange >= 0 ? '+' : '';
                const isHot = i < 3;
                
                const card = document.createElement('div');
                card.className = `token-card bg-gray-900/80 rounded-xl p-4 border ${isHot ? 'border-red-500/50 glow' : 'border-gray-800'} hover:border-red-500`;
                card.innerHTML = `
                    ${isHot ? '<div class="text-xs text-red-400 font-semibold mb-2">üî• HOT</div>' : ''}
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1 min-w-0">
                            <h3 class="font-bold text-lg truncate">${token.baseToken?.symbol || '???'}</h3>
                            <p class="text-gray-500 text-xs truncate">${token.baseToken?.name || ''}</p>
                        </div>
                        <span class="${changeColor} ${changeBg} px-2 py-1 rounded text-sm font-semibold">${changeSign}${priceChange.toFixed(1)}%</span>
                    </div>
                    <div class="grid grid-cols-2 gap-2 text-sm mb-4">
                        <div class="bg-gray-800/50 rounded p-2">
                            <p class="text-gray-500 text-xs">Volume 24h</p>
                            <p class="text-green-400 font-semibold">$${formatNumber(token.volume?.h24)}</p>
                        </div>
                        <div class="bg-gray-800/50 rounded p-2">
                            <p class="text-gray-500 text-xs">Liquidity</p>
                            <p class="font-semibold">$${formatNumber(token.liquidity?.usd)}</p>
                        </div>
                        <div class="bg-gray-800/50 rounded p-2">
                            <p class="text-gray-500 text-xs">Price</p>
                            <p class="font-semibold">$${parseFloat(token.priceUsd || 0).toFixed(8)}</p>
                        </div>
                        <div class="bg-gray-800/50 rounded p-2">
                            <p class="text-gray-500 text-xs">MCap</p>
                            <p class="font-semibold">$${formatNumber(token.marketCap)}</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <a href="${token.url}" target="_blank" class="flex-1 text-center bg-gray-800 hover:bg-gray-700 py-2 rounded text-xs font-medium">DexScreener</a>
                        <a href="https://birdeye.so/token/${token.baseToken?.address}?chain=solana" target="_blank" class="flex-1 text-center bg-gray-800 hover:bg-gray-700 py-2 rounded text-xs font-medium">Birdeye</a>
                        <a href="https://solscan.io/token/${token.baseToken?.address}" target="_blank" class="flex-1 text-center bg-gray-800 hover:bg-gray-700 py-2 rounded text-xs font-medium">Solscan</a>
                    </div>
                `;
                tokensDiv.appendChild(card);
            });
        }

        function updateStats() {
            document.getElementById('tokenCount').textContent = allTokens.length;
            const totalVol = allTokens.reduce((sum, t) => sum + (t.volume?.h24 || 0), 0);
            document.getElementById('totalVolume').textContent = '$' + formatNumber(totalVol);
            const avgChg = allTokens.reduce((sum, t) => sum + (t.priceChange?.h24 || 0), 0) / allTokens.length;
            const avgEl = document.getElementById('avgChange');
            avgEl.textContent = (avgChg >= 0 ? '+' : '') + avgChg.toFixed(1) + '%';
            avgEl.className = `text-2xl font-bold ${avgChg >= 0 ? 'text-green-400' : 'text-red-400'}`;
            document.getElementById('lastUpdateTime').textContent = new Date().toLocaleTimeString('en-US', {hour: '2-digit', minute: '2-digit'});
        }

        function formatNumber(num) {
            if (!num) return '0';
            if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toFixed(2);
        }

        function openChecklist() { document.getElementById('checklistModal').classList.remove('hidden'); }
        function closeChecklist() { document.getElementById('checklistModal').classList.add('hidden'); }

        document.getElementById('minVolume').addEventListener('change', fetchTokens);
        document.getElementById('minLiquidity').addEventListener('change', fetchTokens);
        document.getElementById('sortBy').addEventListener('change', () => { 
            allTokens.sort((a, b) => {
                const sortBy = document.getElementById('sortBy').value;
                if (sortBy === 'volume') return (b.volume?.h24 || 0) - (a.volume?.h24 || 0);
                if (sortBy === 'liquidity') return (b.liquidity?.usd || 0) - (a.liquidity?.usd || 0);
                if (sortBy === 'change') return (b.priceChange?.h24 || 0) - (a.priceChange?.h24 || 0);
                if (sortBy === 'mcap') return (b.marketCap || 0) - (a.marketCap || 0);
                return 0;
            });
            renderTokens();
        });

        fetchTokens();
        setInterval(fetchTokens, 30000);
    </script>
</body>
</html>
